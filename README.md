# DepressionMRI_ML

Instructions on how to use the codebase to come! 

Major Depression is a complex psychological disorder which the World Health Organization (WHO) designates as the single largest contributor to global disability\cite{b0}. If untreated, up to 10\% of individuals with depressive episodes will become suicidal \cite{b1}. Major depression is generally characterized by cognitive impairments, pervasive depressed moods, and feelings of worthlessness \cite{b2}. One hurdle to the identification and treatment of depression is that the majority of diagnoses are derived from self-reported symptoms \cite{b2}. Although we understand the brain's emotional circuitry to some extent, Major Depression is complex enough that the contributions of neuroimaging to diagnosis has been limited \cite{b2}.

Here, we attempt to improve our fundamental understandings of the neural mechanisms underlying depression. A recent paper by Melnikov et al. introduces a novel dataset which contains resting fMRI brain scans from patients with varying degrees of Depression \cite{b3}. They successfully contrast several brain components from controls both 1) at a baseline scan, and 2) after psychological treatment \cite{b3}. Although the authors employ sophisticated pre-processing and statistical analysis, the advantages of machine learning and AI are not investigated. Instead, they divide up the brain into components whose attributesâ€™ grey matter, white matter, and cerebrospinal fluid metrics can be compared. The corresponding dataset published on the \textit{OpenNeuroCV} online and open-sourced platform presents the opportunity to expand on their analyses. 

We use Convolutional Neural Networks (CNN) to analyze the brain without the need for predefined feature selection. Our prediction is that we will be able to design a neural network that can differentiate brains that belong to majorly Depressed individuals, and feature importance algorithms will then elucidate brain regions that are especially important for model prediction. This research has several goals: 1) to improve our understanding of the mechanistic patterns associated with depression, 2) to help contribute to an eventual imaging based depression diagnostic test.

The principal feature importance algorithm employed here is permutation analysis - a procedure which "noises-out" select brain regions and evaluates whether prediction is impacted. We hope that this can contribute to our understanding of the disease by highlighting several brain regions, or combinations of brain data throughout the fMRI that are predictive. In order to supplement this analysis, we attempt to employ Grad-CAM\cite{gradcam}, which directly gathers the gradients output by the final convolutional layer and produces a coarse localization map highlighting important input features. Should these two methods identify similar regions of interest, then that would be a very good indication that the feature is important for classifying depression. 

In order to classify Major Depression, we employ several CNN architectures including and not limited to models that take different dimensional inputs and models with different numbers of layers/parameters. Our most successful implementation comprises a model with 2 convolutional layers and 2 max pooling layers that takes whole-patient brain scans as input, and achieves: 1) Recall of 0.51, 2) Precision of 0.85, 3) AUROC of 0.65, 4) AUPRC of 0.79 and 5) Accuracy of 0.55. 


